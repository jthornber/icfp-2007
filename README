Here's the code I wrote whilst trying to save Endo.  Alas I didn't.  Poor Endo.